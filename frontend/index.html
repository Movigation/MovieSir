<!doctype html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />

  <!-- ===== PWA ê¸°ë³¸ ì„¤ì • ===== -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="manifest" href="/manifest.json" />

  <!-- ì„±ëŠ¥ ìµœì í™”: ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ ì‚¬ì „ ì—°ê²° -->
  <link rel="preconnect" href="https://image.tmdb.org" />

  <!-- í°íŠ¸ ìµœì í™”: FCP ê°œì„ ì„ ìœ„í•œ ë¹„ë™ê¸° ë¡œë”© -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Jua&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Jua&display=swap" media="print"
    onload="this.media='all'">
  <noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Jua&display=swap">
  </noscript>

  <!-- ===== ë°˜ì‘í˜• ì›¹ í‘œì¤€: ë·°í¬íŠ¸ ì„¤ì • ===== -->
  <!-- initial-scale=1.0: ì´ˆê¸° í™•ëŒ€/ì¶•ì†Œ ë¹„ìœ¨ 1:1 -->
  <!-- width=device-width: ë·°í¬íŠ¸ ë„ˆë¹„ë¥¼ ê¸°ê¸° í™”ë©´ ë„ˆë¹„ì— ë§ì¶¤ -->
  <!-- maximum-scale=5.0: ìµœëŒ€ 5ë°°ê¹Œì§€ í™•ëŒ€ ê°€ëŠ¥ (ì ‘ê·¼ì„±) -->
  <!-- user-scalable=yes: ì‚¬ìš©ì í™•ëŒ€/ì¶•ì†Œ í—ˆìš© -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />

  <!-- ===== ğŸ”’ ë³´ì•ˆ: Content Security Policy (XSS ë°©ì§€) ===== -->
  <!-- script-src: ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì™€ ê°™ì€ ë„ë©”ì¸ í—ˆìš© -->
  <!-- style-src: ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í—ˆìš© (Tailwind, emotion ë“±) -->
  <!-- img-src: ëª¨ë“  ì´ë¯¸ì§€ ì†ŒìŠ¤ í—ˆìš© (ì˜í™” í¬ìŠ¤í„° ë“±) -->
  <!-- connect-src: API ì—”ë“œí¬ì¸íŠ¸ í—ˆìš© -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; 
                 script-src 'self' 'unsafe-inline' 'unsafe-eval'; 
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                 font-src 'self' https://fonts.gstatic.com; 
                 img-src 'self' data: https: http:; 
                 connect-src 'self' http://localhost:8000 http://localhost:8001 https://api.moviesir.com https://auth.moviesir.com;" />

  <!-- ===== PWA: ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € í…Œë§ˆ ìƒ‰ìƒ (ì˜¤ë²„ìŠ¤í¬ë¡¤ ì˜ì—­ ìƒ‰ìƒ) ===== -->
  <!-- Android Chrome (ê¸°ë³¸) -->
  <meta name="theme-color" content="#111827" />
  <!-- iOS Safari (Light Mode) -->
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f9fafb" />
  <!-- iOS Safari (Dark Mode) -->
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#111827" />

  <!-- ===== PWA: iOS ì „ìš© ì„¤ì • ===== -->
  <!-- í™ˆ í™”ë©´ ì¶”ê°€ ì‹œ ì „ì²´í™”ë©´ ëª¨ë“œ (í¬ë¡œìŠ¤ í”Œë«í¼) -->
  <meta name="mobile-web-app-capable" content="yes" />
  <!-- ìƒíƒœë°” ìŠ¤íƒ€ì¼ -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <!-- í™ˆ í™”ë©´ ì•± íƒ€ì´í‹€ -->
  <meta name="apple-mobile-web-app-title" content="Moviesir" />
  <!-- iOS í™ˆ í™”ë©´ ì•„ì´ì½˜ -->
  <link rel="apple-touch-icon" href="/icon-192x192.png" />

  <title>Moviesir - AI ì˜í™” ì¶”ì²œ</title>

  <!-- ë‹¤í¬ëª¨ë“œ FOUC ë°©ì§€: DOM ë Œë”ë§ ì „ì— í…Œë§ˆ ì ìš© (blocking script) -->
  <script>
    // localStorageì—ì„œ í…Œë§ˆë¥¼ ì½ì–´ ì¦‰ì‹œ ì ìš©
    (function () {
      try {
        const theme = localStorage.getItem('theme');
        const isDark = theme === 'dark';

        if (isDark) {
          document.documentElement.classList.add('dark');
        }

        // bodyê°€ ì•„ì§ ì—†ìœ¼ë¯€ë¡œ DOMContentLoaded ì „ì— ì‹¤í–‰ë  inline style ì¶”ê°€
        // CSSê°€ ë¡œë“œë˜ê¸° ì „ì— body ë°°ê²½ìƒ‰ ì¦‰ì‹œ ì ìš©
        const style = document.createElement('style');
        style.textContent = isDark
          ? 'body { background-color: #111827 !important; color: white !important; }'
          : 'body { background-color: #f9fafb !important; color: black !important; }';
        document.head.appendChild(style);

      } catch (e) {
        // localStorage ì ‘ê·¼ ì‹¤íŒ¨ ì‹œ ë¬´ì‹œ (í”„ë¼ì´ë¹— ë¸Œë¼ìš°ì§• ë“±)
      }
    })();
  </script>
</head>

<body>
  <!-- ì´ë¯¸ì§€ ìµœì í™”ë¥¼ ìœ„í•œ ë³´ì´ì§€ ì•ŠëŠ” SVG í•„í„° -->
  <!-- ì‚¬ìš©ë²• í•„í„°ë¥¼ ì ìš©í•  ìœ„ì¹˜ì— poster-optimize ë¥¼ ë¶™ì¸ë‹¤.-->
  <svg style="position: absolute; width: 0; height: 0; pointer-events: none;">
    <filter id="poster-optimize-filter">
      <!-- 1. Denoise: ë¯¸ì„¸í•œ ê°€ìš°ì‹œì•ˆ ë¸”ëŸ¬ë¡œ ë…¸ì´ì¦ˆ ì™„í™” -->
      <feGaussianBlur in="SourceGraphic" stdDeviation="0.2" result="denoised" />
      <!-- 2. Sharpen: Convolution Matrixë¥¼ ì´ìš©í•œ ì„ ëª…í™” (4: Sharp) -->
      <feConvolveMatrix in="denoised" order="3" preserveAlpha="true" kernelMatrix="0 -1 0 -1 5 -1 0 -1 0"
        result="sharpened" />
      <!-- 3. Color correction: ì±„ë„ì™€ ëŒ€ë¹„ ë¯¸ì„¸ ì¡°ì • -->
      <feColorMatrix in="sharpened" type="matrix" values="1.05 0 0 0 -0.02
                                                          0 1.05 0 0 -0.02
                                                          0 0 1.05 0 -0.02
                                                          0 0 0 1 0" />
    </filter>
  </svg>
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>

</html>